<!DOCTYPE html>
<html lang="en" class="scroll-smooth" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Style Bazaar â€“ Discover beauty, fashion, and lifestyle products from trusted sellers.">
    <meta name="keywords" content="fashion, cosmetics, beauty, jewelry, online store">
    <title>{% block title %}Style Bazaar{% endblock %}</title>

    <!-- Tailwind CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Tailwind Config: Dark Mode + Custom Colors -->
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#ec4899',        // pink-500
                        'primary-hover': '#db2777', // pink-600
                        accent: '#a855f7',         // purple-500 (optional for gradients)
                    },
                },
            },
        }
    </script>

    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Inter', system-ui, sans-serif; }
    </style>

    {% block extra_head %}{% endblock %}
</head>

<body class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 min-h-screen flex flex-col transition-colors duration-500">

    <!-- PRELOADER (matches body bg exactly) -->
    <div id="preloader" class="fixed inset-0 z-50 flex items-center justify-center bg-gray-50 dark:bg-gray-900 transition-colors duration-700">
        <div class="text-center">
            <div class="relative w-32 h-32 mx-auto mb-8">
                <div class="absolute inset-0 rounded-full bg-gradient-to-r from-primary to-accent animate-ping opacity-75"></div>
                <div class="absolute inset-0 rounded-full bg-gradient-to-r from-primary to-purple049 animate-ping animation-delay-1000 opacity-50"></div>
                <div class="absolute inset-4 rounded-full bg-gray-50 dark:bg-gray-900"></div>
                <div class="absolute inset-0 flex items-center justify-center">
                    <div class="text-5xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-primary to-accent">
                        SB
                    </div>
                </div>
            </div>
            <h2 class="text-2xl font-bold text-gray-800 dark:text-gray-100 mb-2">Style Bazaar</h2>
            <p class="text-gray-600 dark:text-gray-400">Loading your beauty experience...</p>
            <div class="mt-8 w-64 h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden mx-auto">
                <div id="loader-bar" class="h-full bg-gradient-to-r from-primary to-accent rounded-full w-0 transition-all duration-500"></div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div id="app-content" class="flex flex-col min-h-screen opacity-0 transition-opacity duration-1000">
        {% include "includes/navbar.html" %}

        <!-- Flash Messages -->
        {% if messages %}
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-6">
            {% for message in messages %}
            <div class="mb-4 max-w-3xl mx-auto p-4 rounded-lg shadow-sm border flex items-center gap-3
                {% if message.tags == 'success' %}bg-green-50 dark:bg-green-900/30 border-green-200 dark:border-green-800 text-green-800 dark:text-green-200
                {% elif message.tags == 'error' %}bg-red-50 dark:bg-red-900/30 border-red-200 dark:border-red-800 text-red-800 dark:text-red-200
                {% elif message.tags == 'warning' %}bg-yellow-50 dark:bg-yellow-900/30 border-yellow-200 dark:border-yellow-800 text-yellow-800 dark:text-yellow-200
                {% else %}bg-blue-50 dark:bg-blue-900/30 border-blue-200 dark:border-blue-800 text-blue-800 dark:text-blue-200{% endif %}">
                {{ message }}
            </div>
            {% endfor %}
        </div>
        {% endif %}

        <main class="flex-grow">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
                {% block content %}{% endblock %}
            </div>
        </main>

        {% include "includes/footer.html" %}
    </div>

    <!-- Dark Mode + Preloader Script -->
    <script>
        // Dark mode: respect saved preference or system setting
        (function () {
            const savedTheme = localStorage.getItem('theme');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            const shouldBeDark = savedTheme === 'dark' || (!savedTheme && prefersDark);

            if (shouldBeDark) {
                document.documentElement.classList.add('dark');
                document.documentElement.setAttribute('data-theme', 'dark');
            } else {
                document.documentElement.classList.remove('dark');
                document.documentElement.setAttribute('data-theme', 'light');
            }
        })();

        // Listen for system theme changes
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {
            if (!localStorage.getItem('theme')) {
                if (e.matches) {
                    document.documentElement.classList.add('dark');
                    document.documentElement.setAttribute('data-theme', 'dark');
                } else {
                    document.documentElement.classList.remove('dark');
                    document.documentElement.setAttribute('data-theme', 'light');
                }
            }
        });

        // Preloader
        document.addEventListener('DOMContentLoaded', function () {
            const preloader = document.getElementById('preloader');
            const appContent = document.getElementById('app-content');
            const loaderBar = document.getElementById('loader-bar');

            let progress = 0;
            const interval = setInterval(() => {
                progress += Math.random() * 15 + 10;
                if (progress >= 100) {
                    progress = 100;
                    clearInterval(interval);
                }
                loaderBar.style.width = progress + '%';
            }, 250);

            setTimeout(() => {
                clearInterval(interval);
                loaderBar.style.width = '100%';
                preloader.style.opacity = '0';
                appContent.style.opacity = '1';
                setTimeout(() => preloader.remove(), 800);
            }, 3000);
        });
    </script>

    <!-- Custom Animations -->
    <style>
        @keyframes ping {
            75%, 100% {
                transform: scale(1.4);
                opacity: 0;
            }
        }
        .animate-ping {
            animation: ping 1.8s cubic-bezier(0, 0, 0.2, 1) infinite;
        }
        .animation-delay-1000 {
            animation-delay: 1s;
        }
    </style>
</body>
</html>